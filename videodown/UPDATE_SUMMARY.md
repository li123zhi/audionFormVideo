# 视频处理工具更新说明

## 更新内容

### 1. 界面改进 - 使用选项卡(Tabs)组织功能

将VideoRecomp.vue页面重构为选项卡式布局，提供更清晰的功能组织：

#### 选项卡1: 字幕视频生成
- 上传原视频和字幕文件
- 配置字幕样式（字体大小、颜色、加粗、斜体、描边、阴影）
- 配置字幕布局（底部边距、最大宽度比例）
- 自动换行支持
- 生成软字幕和硬字幕视频

#### 选项卡2: 音频分割 ✨新增
- 根据字幕文件分割音频
- 支持从视频提取音频或直接使用音频文件
- 自动生成静音填充字幕间隙
- 每个字幕对应一个MP3文件
- ZIP打包下载所有音频文件

### 2. 音频分割功能详细说明

#### 功能特点
- ✅ **智能分割**: 根据SRT字幕的时间戳精确分割音频
- ✅ **音频源支持**:
  - 视频文件（自动提取音频）
  - 音频文件（直接处理）
- ✅ **静音填充**: 在字幕间隙生成对应时长的静音MP3文件
- ✅ **批量下载**: 所有音频文件打包为ZIP下载

#### 文件命名规则
```
字幕音频: subtitle_001_0.500-3.200.mp3
静音文件: silence_001_3.200-3.500.mp3
```

#### API接口
- `POST /api/subtitle-audio-split` - 上传并开始分割
- `GET /api/subtitle-audio-split/status/{task_id}` - 查询状态
- `GET /api/subtitle-audio-split/download/{task_id}` - 下载结果

### 3. 使用流程

#### 字幕视频生成流程
1. 选择"字幕视频生成"标签页
2. 上传原视频文件（必需）
3. 上传SRT字幕文件（必需）
4. 配置字幕样式（可选）
5. 点击"开始生成"
6. 等待处理完成
7. 下载软字幕视频和硬字幕视频

#### 音频分割流程
1. 选择"音频分割"标签页
2. 上传SRT字幕文件（必需）
3. 上传视频或音频文件（必需）
4. 选择是否生成静音（默认开启）
5. 点击"开始分割"
6. 等待处理完成
7. 下载ZIP压缩包（包含所有音频文件）

### 4. 技术实现

#### 前端改进
- 使用 Element Plus 的 `el-tabs` 组件组织功能
- 添加独立的音频分割状态管理
- 实现文件上传、进度追踪、结果下载
- 响应式设计，移动端友好

#### 后端API
- 新增音频分割任务队列
- 支持后台异步处理
- 实时进度更新
- 自动生成静音文件
- ZIP打包下载

### 5. 文件结构

```
前端修改:
videorecomp/frontend/src/
├── views/VideoRecomp.vue    # 重构为选项卡布局
└── services/api.js           # 添加音频分割API

后端修改:
videorecomp/backend/
└── app.py                    # 添加音频分割API端点
```

### 6. 配置选项

#### 字幕视频生成配置
| 参数 | 范围 | 默认值 | 说明 |
|------|------|--------|------|
| fontSize | 12-48 | 24 | 字体大小（像素） |
| fontColor | 颜色选择器 | #FFFFFF | 字体颜色 |
| bold | 开关 | false | 加粗 |
| italic | 开关 | false | 斜体 |
| outline | 开关 | true | 描边 |
| shadow | 开关 | true | 阴影 |
| bottomMargin | 20-200 | 50 | 底部边距（像素） |
| maxWidthRatio | 50-100% | 90% | 字幕宽度比例 |

#### 音频分割配置
| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| srt | File | 必需 | SRT字幕文件 |
| video/audio | File | 必需 | 视频或音频文件 |
| useSilence | Boolean | true | 是否生成静音 |

### 7. 使用场景

#### 字幕视频生成
- 为视频添加字幕
- 创建可开关字幕的视频（软字幕）
- 创建字幕烧录的视频（硬字幕）
- 批量处理视频字幕

#### 音频分割
- 配音制作：将长音频分割成短片段
- 音频教学：按字幕组织教学内容
- 无障碍制作：生成音频描述
- 音频分析：逐句分析音频内容

### 8. 注意事项

1. **文件大小限制**: 最大2GB
2. **处理时间**:
   - 软字幕视频：快速（不重新编码）
   - 硬字幕视频：较慢（需要逐帧处理）
   - 音频分割：中等速度
3. **格式支持**:
   - 视频：MP4, AVI, MOV等
   - 音频：MP3, WAV, AAC等
   - 字幕：SRT格式
4. **浏览器兼容**: 现代浏览器（Chrome, Firefox, Safari, Edge）

### 9. 快捷操作

- 切换功能标签页：点击顶部的标签
- 取消正在进行的任务：点击"取消任务"按钮
- 重新开始：点击"重新生成"或"重新分割"按钮
- 下载结果：点击对应的下载按钮

### 10. 常见问题

**Q: 为什么硬字幕生成比软字幕慢？**
A: 硬字幕需要逐帧处理并重新编码，而软字幕只是将字幕嵌入视频容器。

**Q: 音频分割生成的文件在哪里？**
A: 所有文件打包在ZIP压缩包中，点击下载按钮即可获取。

**Q: 可以同时处理多个任务吗？**
A: 可以，每个任务都有独立的任务ID，可以并行处理。

**Q: 字幕间隙的静音文件有什么用？**
A: 可以用来完整还原原始时间轴，或者用于配音制作时的参考。

## 更新日期
2026-02-04

## 版本
v2.0.0 - 音频分割功能版本
